# üöÄ Guia de Configura√ß√£o - AVC Alerta

Este guia te ajudar√° a configurar o projeto completo do AVC Alerta.

## üìã Pr√©-requisitos

- **Node.js** 18+ ([Download](https://nodejs.org/))
- **npm** ou **yarn**
- **Expo CLI**: `npm install -g @expo/cli`
- Conta no **Firebase** ([Criar conta](https://firebase.google.com/))

## üî• 1. Configurar Firebase

### 1.1 Criar Projeto
1. Acesse [Firebase Console](https://console.firebase.google.com)
2. Clique em **"Criar um projeto"**
3. Digite o nome: `avc-alerta`
4. Desabilite Google Analytics (opcional)
5. Clique em **"Criar projeto"**

### 1.2 Configurar Authentication
1. No menu lateral, clique em **"Authentication"**
2. Clique em **"Come√ßar"**
3. Na aba **"Sign-in method"**:
   - Ative **"Email/senha"**
   - Desabilite **"Link de email"**

### 1.3 Configurar Firestore
1. No menu lateral, clique em **"Firestore Database"**
2. Clique em **"Criar banco de dados"**
3. Escolha **"Iniciar no modo de teste"**
4. Selecione uma localiza√ß√£o pr√≥xima (ex: `southamerica-east1`)

### 1.4 Obter Credenciais

#### Para o Frontend:
1. Clique no √≠cone de **engrenagem** > **"Configura√ß√µes do projeto"**
2. Role at√© **"Seus aplicativos"**
3. Clique no √≠cone **"Web"** (`</>`)
4. Digite o nome: `avc-alerta-frontend`
5. **N√ÉO** marque "Firebase Hosting"
6. Clique em **"Registrar app"**
7. **Copie** a configura√ß√£o que aparece

#### Para o Backend:
1. V√° em **"Configura√ß√µes do projeto"** > **"Contas de servi√ßo"**
2. Clique em **"Gerar nova chave privada"**
3. Clique em **"Gerar chave"**
4. Salve o arquivo JSON baixado

## üñ•Ô∏è 2. Configurar Backend

### 2.1 Instalar Depend√™ncias
```bash
cd backend
npm install
```

### 2.2 Configurar Vari√°veis de Ambiente
```bash
cp .env.example .env
```

### 2.3 Editar arquivo `.env`
Abra o arquivo `backend/.env` e preencha:

```env
# Porta do servidor
PORT=3000

# Ambiente
NODE_ENV=development

# Firebase Admin SDK (do arquivo JSON baixado)
FIREBASE_PROJECT_ID=avc-alerta-xxxxx
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nSUA_CHAVE_PRIVADA_AQUI\n-----END PRIVATE KEY-----\n"
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xxxxx@avc-alerta-xxxxx.iam.gserviceaccount.com

# CORS Origins
CORS_ORIGINS=http://localhost:8081,exp://192.168.1.100:8081

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
```

**‚ö†Ô∏è IMPORTANTE**: 
- Substitua `avc-alerta-xxxxx` pelo ID real do seu projeto
- A `PRIVATE_KEY` deve manter as quebras de linha como `\n`
- Substitua `192.168.1.100` pelo seu IP local

### 2.4 Testar Backend
```bash
npm run dev
```

Se tudo estiver correto, voc√™ ver√°:
```
üöÄ Servidor rodando na porta 3000
üì± Ambiente: development
üîó URL: http://localhost:3000
```

Teste acessando: http://localhost:3000

## üì± 3. Configurar Frontend

### 3.1 Instalar Depend√™ncias
```bash
cd frontend
npm install
```

### 3.2 Configurar Firebase
Edite o arquivo `frontend/services/firebase.ts`:

```typescript
const firebaseConfig = {
  apiKey: "AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
  authDomain: "avc-alerta-xxxxx.firebaseapp.com",
  projectId: "avc-alerta-xxxxx",
  storageBucket: "avc-alerta-xxxxx.appspot.com",
  messagingSenderId: "123456789012",
  appId: "1:123456789012:web:abcdefghijklmnop"
};
```

**‚ö†Ô∏è IMPORTANTE**: Use a configura√ß√£o que voc√™ copiou do Firebase Console.

### 3.3 Configurar API
Edite o arquivo `frontend/services/api.ts` se necess√°rio:

```typescript
const API_BASE_URL = __DEV__ 
  ? 'http://SEU_IP_LOCAL:3000/api'  // Substitua pelo seu IP
  : 'https://your-production-api.com/api';
```

### 3.4 Testar Frontend
```bash
npm run dev
```

## üîß 4. Solucionar Problemas do QR Code

### Problema 1: QR Code n√£o funciona
**Solu√ß√£o**: Verificar se celular e PC est√£o na mesma Wi-Fi

### Problema 2: Erro de conex√£o
**Solu√ß√£o**: Usar IP espec√≠fico
```bash
# Descubra seu IP local
ipconfig  # Windows
ifconfig  # Mac/Linux

# Use o IP espec√≠fico
npx expo start --host 192.168.1.100
```

### Problema 3: Cache corrompido
**Solu√ß√£o**: Limpar cache
```bash
npx expo start --clear --reset-cache
```

### Problema 4: Rede restritiva
**Solu√ß√£o**: Usar t√∫nel
```bash
npx expo start --tunnel
```

## üß™ 5. Testar Integra√ß√£o

### 5.1 Testar Backend
1. Acesse: http://localhost:3000
2. Deve mostrar: `"AVC Alerta API est√° funcionando!"`

### 5.2 Testar Frontend
1. Abra o app no celular/emulador
2. Tente registrar um usu√°rio
3. Verifique se os dados aparecem no Firebase Console

### 5.3 Testar Comunica√ß√£o
1. No app, v√° para **"Monitoramento"**
2. Adicione um registro de press√£o arterial
3. Verifique se aparece no Firestore Console

## üöÄ 6. Deploy (Opcional)

### Backend - Railway
1. Acesse [Railway](https://railway.app)
2. Conecte seu GitHub
3. Deploy o projeto
4. Configure as vari√°veis de ambiente

### Frontend - Expo EAS
```bash
npm install -g eas-cli
eas login
eas build:configure
eas build --platform android
```

## üìû 7. Suporte

### Problemas Comuns:

**Erro: "Firebase project not found"**
- Verifique se o `PROJECT_ID` est√° correto no `.env`

**Erro: "CORS policy"**
- Adicione seu IP/URL no `CORS_ORIGINS` do backend

**Erro: "Network request failed"**
- Verifique se o backend est√° rodando
- Confirme o IP no `API_BASE_URL` do frontend

**QR Code n√£o funciona**
- Siga as solu√ß√µes da se√ß√£o 4

### Logs √öteis:
```bash
# Backend
npm run dev

# Frontend  
npx expo start --clear

# Ver logs do dispositivo
npx expo logs
```

---

üéâ **Parab√©ns!** Seu projeto AVC Alerta est√° configurado e funcionando!

Para d√∫vidas, verifique os logs ou abra uma issue no reposit√≥rio.